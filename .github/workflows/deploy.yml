name: üöÄ Build and deploy JupyterLite (Pyodide CDN)

on:
  push:
    branches: [ main ]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      # 1Ô∏è‚É£ Clonar el repositorio
      - uses: actions/checkout@v4

      # 2Ô∏è‚É£ Instalar JupyterLite y las dependencias necesarias
      - name: Install JupyterLite and dependencies
        run: |
          pip install --upgrade pip
          pip install \
            jupyterlite \
            jupyterlite-core \
            jupyterlite-pyodide-kernel \
            jupyter-server \
            jupyterlab_server

      # 3Ô∏è‚É£ Construir el sitio usando Pyodide desde CDN
      #    Esto evita tener que empaquetar los binarios localmente.
      - name: Build JupyterLite site with CDN Pyodide
        run: |
          echo "üß± Building JupyterLite site using CDN Pyodide"
          jupyter lite build \
            --output-dir _output \
            --contents notebooks \
            --lite-dir . \
            --pyodide-cdn https://cdn.jsdelivr.net/pyodide/v0.26.1/full/

      # 4Ô∏è‚É£ Desplegar el sitio en GitHub Pages
      - name: Deploy to GitHub Pages
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_branch: gh-pages
          publish_dir: ./_output
